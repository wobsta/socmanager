$def with (member)
$var script:
     <script src="../static/jquery.min.js" type="text/javascript"></script>
     <script type="text/javascript">
       $$(function() {
         $$("#show_archive").append(' <a href="#" id="toggle_archive">mehr…</a>');
         $$("#archive").css("display", "none");
         $$("#toggle_archive").live("click", function() {
           $$("#toggle_archive").text($$("#archive").is(":hidden") ? "weniger…" : "mehr…");
           $$("#archive").toggle();
           return false;
         });
       });
     </script>
<h1>Willkommen $member.firstname $member.lastname</h1>
$if "admin" in [tag.name for tag in member.tags]:
    <p>Du bist als <b>Administrator</b> in der Mitgliederliste des Schwäbischen Oratorienchors geführt und hast deshalb Zugriff auf die <a href="admin/members.html">Mitgliederverwaltung</a>.</p>
$elif "Verein" in [tag.name for tag in member.tags]:
    <p>Du bist als <b>Vereinsmitglied</b> in der Mitgliederliste des Schwäbischen Oratorienchors geführt.</p>
$elif "inaktiv" in [tag.name for tag in member.tags]:
    <p>Du bist als <b>inaktives Mitglied</b> in der Mitgliederliste des Schwäbischen Oratorienchors geführt.</p>
$else:
    <p>Du bist als <b>aktives Mitglied</b> in der Mitgliederliste des Schwäbischen Oratorienchors geführt.</p>
$def show(*args):
    $ args = [arg for arg in args if arg]
    $if args:
        $for arg in args:
            $if not loop.first:
                , \
            $arg\
    $else:
        Keine Daten vorhanden.
<dl>
  <dt>Deine Mitgliederdaten:<dt>
  <dd>
    <p>Adresse: $show(member.street, member.zip, member.city)</p>
    <p>Kontakt: $show(member.phone, member.email)</p>
    <p>Geburtstag: $show(member.birthday and member.birthday.strftime("%d.%m.%Y"))</p>
    <p>Du kannst Deine Mitgliederdaten <a href="data.html">selbst aktualisieren</a>.</p>
    <p>Tags: $show(*[tag.name for tag in member.tags if tag.visible]) (<a href="tags.html">Details anzeigen</a>)</p>
  </dd>
  <dt>Zugangsdaten:</dt>
  <dd>
    <p>Du kannst Deine <a href="access.html">Zugangsdaten konfigurieren</a>, um Dich nicht nur per E-Mail-Link anmelden zu können.</p>
  </dd>
  <dt>Mitglieder-Seiten:</dt>
  <dd>
    $if "inaktiv" in [tag.name for tag in member.tags]:
        <p>Als inaktives Mitglied hast Du <b>keinen</b> Zugang zu den Mitglieder-Seiten.</p>
    $else:
        <p>Als aktives Mitglied hast Du Zugang zum <a href="wiki/">Mitglieder-Wiki</a> und zu den <a href="photos.html">Fotoalben</a>.</p>
  </dd>
  $if "Verein" in [tag.name for tag in member.tags]:
      <dt>Vereins-Seiten:</dt>
      <dd><p>Als aktives Vereinsmitglied hast Du Zugang zum <a href="verein/">Vereins-Wiki</a>.</p></dd>
$def show_message(message):
    $if message.circular.id != 1:
        <li><a href="message/$message.circular.name/show.html">$message.circular.title vom $message.circular.created.strftime("%d.%m.%Y")</a></li>
    $else:
        <li><a href="message/$message.circular.name/show.html">$message.circular.title</a></li>
  <dt>Chorbriefe:</dt>
  <dd>
    $ new_messages = [message for message in member.messages if not message.access_by]
    $ old_messages = [message for message in member.messages if message.access_by]
    $if new_messages:
        $if len(new_messages) > 1:
            <p>Du hast <b>$len(new_messages) ungelesene Chorbriefe</b>:</p>
        $else:
            <p>Du hast <b>einen ungelesenen Chorbrief</b>:</p>
        <ul>
          $for message in new_messages:
              $:show_message(message)
        </ul>
    $else:
        <p>Du hast keine ungelesenen Chorbriefe.</p>
    $if old_messages:
        $if len(old_messages) > 1:
            <p id="show_archive">Es sind $len(old_messages) gelesene Chorbriefe in Deinem Archiv.</p>
        $else:
            <p id="show_archive">Du hast einen gelesenen Chorbrief in Deinem Archiv.</p>
        <ul id="archive">
          $for message in old_messages:
              $:show_message(message)
        </ul>
    $else:
        <p>Es sind keine gelesenen Chorbriefe in Deinem Archiv.</p>
  </dd>
</dl>
